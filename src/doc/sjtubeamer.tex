\documentclass[
    UTF8,
    heading=true,
    12pt
]{ctexrep}

\pagestyle{plain}

\usepackage{pifont}

\ctexset {
    part = {
        format = \bfseries\Huge,
        number = ,
        name = \themename,
        nameformat = \huge
    },
    chapter = {
        beforeskip = 0pt,
        fixskip = true,
        format = \bfseries,
        name = ,
        nameformat = \hfill\huge,
        number = \arabic{chapter},
        aftername = \,\par\hfill,
        titleformat = \LARGE,
        aftertitle = \par\bigskip\nointerlineskip\rule{\linewidth}{2bp}\par
    },
    section = {
        format = \bfseries\large\raggedright,
        number = \raisebox{-.1ex}{\ding{\numexpr181 + \arabic{section}}},
        numberformat = \Large
    }
}

\usepackage[colorlinks]{hyperref}

\usepackage{enumitem}
\setlist[enumerate]{
    itemsep=0pt,
    left=\parindent,
    label=\raisebox{-.1ex}{\large\ding{\numexpr171 + \arabic*}}
}

\usepackage{tcolorbox}
\newtcbox{\xbutton}[1][red]{on line,
arc=3pt,colback=#1!50!black,colframe=#1!50!black,
before upper={\rule[-3pt]{0pt}{10pt}},boxrule=1pt,
boxsep=0pt,left=6pt,right=6pt,top=2pt,bottom=0pt,
fontupper=\sffamily,colupper=white}

\usepackage{iftex}
\ifpdftex 
    % Windows should always use pdflatex to compile this doc
\else
    % *nix should always use xelatex to support fontawesome and ctex
    \usepackage{fontspec}
    \defaultfontfeatures{Extension = .otf}
\fi
\usepackage{fontawesome}
\usepackage{hologo}

\tcbuselibrary{listingsutf8}
\lstset{
    language=[LaTeX]TeX,
    basicstyle=\ttfamily,
    columns=flexible, 
    emph=[1]{usetheme},
    emphstyle=\color{blue},
    extendedchars=false,
    lineskip=-.1cm,
    breaklines
}

\tcbuselibrary{skins,raster}
\newtcbinputlisting[auto counter]{\beamerdemo}[2][1]{
    enhanced jigsaw,
    lower separated=false,
    leftlower=0pt,rightlower=0pt,middle=0pt,
    listing side comment,
    listing file={tutourial/#2},
    listing options={
        style=tcblatex,
        texcsstyle=*\color{red!70!black}
    },
    pdf comment,
    comment style={
        drop lifted shadow,
        graphics pages={#1},
        raster columns=1
    },
    tile,
    title={\faEdit 示例 \thetcbcounter}
}

\newenvironment{beamerdemoraster}[3][]{
    \begin{tcbraster}[raster columns=3,colframe=#2,colback=white,
        colbacktitle=#2!50!white,fonttitle=\small\bfseries\ttfamily,fontupper=\ttfamily,
        left=0pt,right=0pt,top=0pt,bottom=0pt,boxsep=0pt,boxrule=0.6pt,
        toptitle=1mm,bottomtitle=1mm,drop lifted shadow,center title,
        graphics pages={#1}]
        \tcbincludepdf{tutourial/#3.pdf}
    \end{tcbraster}
}{}

\def\themename{\textsf{SJTUBeamer}}

\begin{document}
    \title{\themename}
    \date{\today}
    % \maketitle

    \chapter*{\themename\ 介绍}

    \themename\ 是基于 \verb"beamer" 文档类的主题宏集。

    \setcounter{tocdepth}{0}
    \tableofcontents

    \part{基础操作}
    \chapter{安装}

    \section{运行环境}

    为了使用 \themename\ 的全部功能，请使用下者之一：
    \begin{enumerate}
        \item \href{https://miktex.org/}{MiK\TeX\ }
        \item \href{https://mirrors.sjtug.sjtu.edu.cn/ctan/systems/texlive/Images/texlive2021-20210325.iso}{\TeX\ Live} 2020 及以上版本
    \end{enumerate}

    % 上传至 Overleaf 后添加对应在线步骤
    % 上传至 CTAN 后本段可以直接更改为安装宏包的标准流程
    \section{下载模板}

    \begin{enumerate}
        \item 前往 GitHub 上的 \faGithub{}~\href{https://github.com/sjtug/SJTUBeamer}{sjtug/SJTUBeamer} 页面，点击 \xbutton[green]{Code} 按钮下载压缩文件，在解压后的主目录里新建 \TeX{} 源文件即可调用该模板。
        \item 或者点击进入存储库侧栏的 \href{https://github.com/sjtug/SJTUBeamer/releases}{\textsf{Releases}} 下载查看最新发布版本，并下载 \textsf{Assets} 栏的 \texttt{sjtubeamer-ctan.zip}。
    \end{enumerate}
    
    \section{测试模板}

    \begin{enumerate}
        \item[ \faWindows] Windows 系统采用 \hologo{pdfLaTeX} 编译以获得更快的编译速度。
        \item[ \faApple\ \faLinux] *nix 系统采用 \hologo{XeLaTeX} 编译以获得中文支持。
    \end{enumerate}

    下面的代码可以用于测试 \themename\ 是否可以正常使用。

    \beamerdemo[1]{step1}
    
    {\small
        \begin{enumerate}
            \item 第一行载入 \verb"ctex" 宏包提供的 \verb"ctexbeamer" 文档类。如果不需要中文支持，可以直接使用 \verb"beamer" 文档类。如果需要使用 16:9 的荧幕比例，可以参照示例 2 的相关参数。
            \item 第二行载入 \verb"sjtubeamer" 主题。
            \item 使用 \verb"document" 环境进入文档主体。
            \item 使用 \verb"frame" 环境创建新的幻灯片（帧）。
            \item 在帧中输入文字即可在屏幕垂直居中位置产生文字。
        \end{enumerate}
    }

    \clearpage

    \chapter{样式}

    在开始填入内容前，应当首先确定需要使用的样式。\themename 目前提供了三种不同的主要主题、两种配色和明暗模式。

    \noindent{\ttfamily\hfil\hspace*{-.5cm} + maxplus \hfil\hfil\hspace*{-.5cm}  + max \hfil\hfil + min \hfil}\par
    \vspace*{-.2cm}
    \begin{beamerdemoraster}[1,3,5,2,4,6]{red}{step2tb}
    \end{beamerdemoraster}

    \begin{beamerdemoraster}[1,2,3]{blue}{step2bd}\marginpar{\ttfamily\raisebox{1.8cm}{+ blue}}\marginpar{\ttfamily\raisebox{-1.8cm}{+ light}}
    \end{beamerdemoraster}
    \vspace*{-.2cm}
    \begin{beamerdemoraster}[1,2,3]{blue}{step2bl}
    \end{beamerdemoraster}

    \themename 可以与 \verb"beamer" 提供的九种外样式随意搭配。

    \def\myincludepdf#1{
        \tcbincludepdf[title={#1},
        colframe=red!50!black,colback=red!10!white,
        colbacktitle=red!50!white,left=0pt,right=0pt,top=0pt,
        bottom=0pt,boxsep=0pt,boxrule=0.6pt,
        toptitle=1mm,bottomtitle=1mm,drop lifted shadow,
        center title,fonttitle=\ttfamily]
        {tutourial/step2#1.pdf}
    }
    \begin{tcbitemize}[raster columns=3, raster equal height,
        left=0pt,right=0pt,top=0pt,
        bottom=0pt,boxsep=0pt,boxrule=0pt]
        \tcbitem \myincludepdf{miniframes}
        \tcbitem \myincludepdf{default}
        \tcbitem \myincludepdf{infolines}
        \tcbitem \myincludepdf{smoothbars}
        \tcbitem \myincludepdf{sidebar}
        \tcbitem \myincludepdf{split}
        \tcbitem \myincludepdf{shadow}
        \tcbitem \myincludepdf{tree}
        \tcbitem \myincludepdf{smoothtree}
    \end{tcbitemize}

    \beamerdemo[1]{step2}

    \chapter{草稿}

    在确定了版式后，下一步就要输入文字填入内容了。由于 \LaTeX\ 的编译速度较慢，在打草稿的时候，我们推荐开启 \verb"beamer" 文档类的 \verb"draft" 模式，只关注于内容。在这种模式下，图片都不会被载入，而是使用一个占位符代替。

    \beamerdemo[1]{step3}

    \begin{enumerate}
        \small
        \item 使用 \verb"columns" 环境分栏，也可以采用 \verb"multicol" 宏包提供的 \verb"multicols" 环境。后者还兼容 \verb"article" 文档类。
        \item 该模式也会关闭目录与引用的生成。
    \end{enumerate}

    当然，如果演示文稿的内容过长的话，推荐分成许多个文件编写。最后通过一个主文件拼接起来。如果暂时想专心编写某一部分的内容，可以直接注释掉其他部分的入口。

    \beamerdemo[1]{step3b}

    \part{进阶操作}
    \chapter{修改}

    \part{高级操作}
    \chapter{源代码}

\end{document}